# 4. Correlation test
cor_test <- cor.test(data_clean$price, data_clean$rating, method = "pearson")
cat("\nPearson Correlation Test:\n")
cat("Correlation coefficient (r):", round(cor_test$estimate, 4), "\n")
cat("p-value:", round(cor_test$p.value, 4), "\n")

# 6. Hypothesis decision
if (cor_test$p.value < 0.05) {
  cat("We REJECT the null hypothesis (p < 0.05)\n")
  cat("There is a significant correlation between price and rating\n")
  if (cor_test$estimate > 0) {
    cat("The correlation is positive\n")
  } else {
    cat("The correlation is negative\n")
  }
} else {
  cat("We FAIL TO REJECT the null hypothesis (p > 0.05)\n")
  cat("No significant correlation found between price and rating\n")
}
